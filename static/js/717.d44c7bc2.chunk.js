"use strict";(self.webpackChunkreact_homework_template=self.webpackChunkreact_homework_template||[]).push([[717],{8717:(e,s,r)=>{r.r(s),r.d(s,{default:()=>w});var a=r(5043),t=r(3003),n=r(3892),o=r(899);const l=o.Ik().shape({name:o.Yj().required("Please enter your name!").min(2,"Name must be at least 2 characters long.").max(20,"Name must be less than 20 characters long."),email:o.Yj().required("Please enter your email address.").matches(/^[^@]+@[^@]+\.[^@]+$/,"Please enter a valid email address.").email("Invalid email."),gender:o.Yj().oneOf(["woman","man",""],'Gender must be either "woman" or "man".'),password:o.Yj().min(4,"The passsword must contain at least 4 symbols!").max(8,"The password must contain no more than 8 characters!"),newPassword:o.Yj().min(4,"The passsword must contain at least 4 symbols!").max(8,"The password must contain no more than 8 characters!"),newPasswordRepeat:o.Yj().min(4,"The passsword must contain at least 4 symbols!").max(8,"The password must contain no more than 8 characters!")});var i=r(3768),m=r(3978);const c={passwordTitle:"UserSettingsForm_passwordTitle__dSurm",imageTitle:"UserSettingsForm_imageTitle__MD5jd",formWrapper:"UserSettingsForm_formWrapper__ujyOt",imageWrapper:"UserSettingsForm_imageWrapper__U8Q4Q",image:"UserSettingsForm_image__+uTGC",upload:"UserSettingsForm_upload__t9HPd",imageInput:"UserSettingsForm_imageInput__jEiRz",uploadIcon:"UserSettingsForm_uploadIcon__0dJZK",text:"UserSettingsForm_text__EFO7E",inputTitle:"UserSettingsForm_inputTitle__ESP2R",genderInputWrapper:"UserSettingsForm_genderInputWrapper__sP33D",genderButton:"UserSettingsForm_genderButton__Z0gIT",userInroWrapper:"UserSettingsForm_userInroWrapper__RJtcK",userInputWrap:"UserSettingsForm_userInputWrap__dhGBC",userInputTitle:"UserSettingsForm_userInputTitle__stZDh",userInput:"UserSettingsForm_userInput__0SRz+",error:"UserSettingsForm_error__1O6VL",accentText:"UserSettingsForm_accentText__7Kn5v",iconImportant:"UserSettingsForm_iconImportant__OOWTR",accentTextL:"UserSettingsForm_accentTextL__rS9Gm",header:"UserSettingsForm_header__nswTc",label:"UserSettingsForm_label__DuSbd",formGroupPassword:"UserSettingsForm_formGroupPassword__yDKPK",input:"UserSettingsForm_input__7fym4",errorMessage:"UserSettingsForm_errorMessage__NPkUw",inputWrapper:"UserSettingsForm_inputWrapper__mv+is",buttonWrapper:"UserSettingsForm_buttonWrapper__gGKFi",passwordToggleIcon:"UserSettingsForm_passwordToggleIcon__lk76R",btnWrapper:"UserSettingsForm_btnWrapper__eG2bt",placeholder:"UserSettingsForm_placeholder__qf4U-",flexWrap:"UserSettingsForm_flexWrap__RvIfu",settingsWrapper:"UserSettingsForm_settingsWrapper__cqFYn",userWrapper:"UserSettingsForm_userWrapper__Bkg+5",userSettings:"UserSettingsForm_userSettings__-yspq",formFlexWrapper:"UserSettingsForm_formFlexWrapper__xqYgJ",formFlexItem:"UserSettingsForm_formFlexItem__mnUxu",passwordWrapper:"UserSettingsForm_passwordWrapper__ltSFO",cancelButton:"UserSettingsForm_cancelButton__nvpjo"};var p=r(7920),d=r(8344),u=r(6213);const g=(0,d.zD)("user/getUser",(async(e,s)=>{try{const s=await u.A.get(`/user/${e}`);return console.log("answear user",s.data),s.data}catch(t){var r,a;return s.rejectWithValue((null===(r=t.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||t.message)}})),_=(0,d.zD)("user/updateUser",(async(e,s)=>{let{userId:r,userData:a}=e;try{return(await u.A.put(`/user/${r}`,a)).data}catch(o){var t,n;return console.error("Update user error:",o),s.rejectWithValue((null===(t=o.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||o.message)}})),h=(0,d.zD)("user/updateAvatar",(async(e,s)=>{let{userId:r,avatarFile:a}=e;try{const e=new FormData;e.append("avatar",a);return(await u.A.patch(`/user/${r}`,e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(o){var t,n;return s.rejectWithValue((null===(t=o.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||o.message)}}));var x=r(579);const w=e=>{let{onClose:s}=e;const r=(0,t.wA)(),o=(0,t.d4)(m.mB)||{},{_id:d,name:u,email:w,gender:j,avatar:v}=o,N=(0,a.useRef)(null),[S,F]=(0,a.useState)(v||null),[U,W]=(0,a.useState)(!1),[I,y]=(0,a.useState)(!1),[b,f]=(0,a.useState)(!1);(0,a.useEffect)((()=>{F(v||null)}),[v]);const T=(0,a.useCallback)((async e=>{const s=e.target.files[0];if(console.log(s),s){const e=URL.createObjectURL(s);F(e);try{await r(h({userId:d,avatarFile:s})),i.oR.success("Avatar updated successfully!")}catch(a){i.oR.error("Error updating avatar. Please try again."),console.error(a)}}}),[r,d]),P=e=>()=>{e((e=>!e))},$=u?u.charAt(0).toUpperCase():"",k={name:u,email:w,gender:j||"woman",oldPassword:"",password:"",repeatPassword:""};return(0,x.jsx)(n.l1,{initialValues:k,validationSchema:l,onSubmit:async e=>{const a=Object.fromEntries(Object.entries(e).filter((e=>{let[s,r]=e;return""!==r&&"avatar"!==s})));try{await r(_({userId:d,userData:a})),i.oR.success("User updated successfully!"),(async()=>{console.log("\u041e\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044f \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u0430..."),await r(g()),console.log("\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u043e\u043d\u043e\u0432\u043b\u0435\u043d\u043e.")})(),s(),console.log("\u041c\u043e\u0434\u0430\u043b\u043a\u0430 \u0437\u0430\u043a\u0440\u0438\u0442\u0430, \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u043e\u043d\u043e\u0432\u043b\u0435\u043d\u043e.")}catch(t){i.oR.error("Error updating user. Please try again."),console.error(t)}},children:e=>{let{setFieldValue:s,isSubmitting:r}=e;return(0,x.jsxs)(n.lV,{children:[(0,x.jsxs)("div",{className:c.settingsWrapper,children:[(0,x.jsxs)("div",{className:c.userWrapper,children:[(0,x.jsx)("p",{className:c.imageTitle,children:"Your Photo"}),(0,x.jsxs)("div",{className:c.imageWrapper,children:[(0,x.jsx)("div",{className:c.imageContainer,children:S?(0,x.jsx)("img",{className:c.image,src:S,loading:"lazy",alt:"User avatar",width:"75",height:"75"}):(0,x.jsx)("div",{className:c.placeholder,children:$})}),(0,x.jsxs)("label",{className:c.upload,children:[(0,x.jsx)("input",{className:c.imageInput,type:"file",accept:"image/*",onChange:e=>{T(e),s("avatar",e.currentTarget.files[0])},ref:N}),(0,x.jsx)("svg",{className:c.uploadIcon,width:"18",height:"18",children:(0,x.jsx)("use",{xlinkHref:`${p.A}#icon-upload`})}),(0,x.jsx)("p",{className:c.text,children:"Upload a photo"})]})]}),(0,x.jsxs)("div",{className:c.formWrapper,children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{className:c.inputTitle,children:"Your gender identity"}),(0,x.jsxs)("div",{className:c.genderInputWrapper,children:[(0,x.jsxs)("label",{className:`${c.genderButton} ${c.text}`,children:[(0,x.jsx)(n.D0,{type:"radio",name:"gender",value:"woman",className:c.genderInput}),"Woman"]}),(0,x.jsxs)("label",{className:`${c.genderButton} ${c.text}`,children:[(0,x.jsx)(n.D0,{type:"radio",name:"gender",value:"man",className:c.genderInput}),"Man"]})]}),(0,x.jsx)(n.Kw,{name:"gender",component:"p",className:c.error})]}),(0,x.jsx)("div",{className:c.formFlexWrapper,children:(0,x.jsx)("div",{className:c.formFlexItem,children:(0,x.jsxs)("div",{className:c.userInfoWrapper,children:[(0,x.jsxs)("div",{className:c.userInputWrap,children:[(0,x.jsx)("label",{className:c.userInputTitle,htmlFor:"name",children:"Your name"}),(0,x.jsx)(n.D0,{type:"text",name:"name",id:"name",className:`${c.userInput} ${c.userSettings} ${c.text}`}),(0,x.jsx)(n.Kw,{name:"name",component:"p",className:c.error})]}),(0,x.jsxs)("div",{className:c.userInputWrap,children:[(0,x.jsx)("label",{className:c.userInputTitle,htmlFor:"email",children:"Email"}),(0,x.jsx)(n.D0,{type:"text",name:"email",id:"email",className:`${c.userInput} ${c.userSettings} ${c.text}`}),(0,x.jsx)(n.Kw,{name:"email",component:"p",className:c.error})]})]})})})]})]}),(0,x.jsxs)("div",{className:c.passwordWrapper,children:[(0,x.jsx)("h2",{className:c.passwordTitle,children:"Password"}),(0,x.jsxs)("div",{className:c.formGroupPassword,children:[(0,x.jsx)("label",{className:c.label,children:"Outdated password:"}),(0,x.jsxs)("div",{className:c.inputWrapper,children:[(0,x.jsx)(n.D0,{type:U?"text":"password",name:"oldPassword",className:`${c.input}`,placeholder:"Password"}),(0,x.jsx)("svg",{className:c.passwordToggleIcon,onClick:P(W),width:"20px",height:"20px",children:(0,x.jsx)("use",{xlinkHref:`${p.A}#${U?"icon-eye":"icon-eye-slash"}`})}),(0,x.jsx)(n.Kw,{name:"oldPassword",component:"p",className:c.errorMessage})]})]}),(0,x.jsxs)("div",{className:c.formGroupPassword,children:[(0,x.jsx)("label",{className:c.label,children:"New Password:"}),(0,x.jsxs)("div",{className:c.inputWrapper,children:[(0,x.jsx)(n.D0,{type:I?"text":"password",name:"password",className:`${c.input}`,placeholder:"Password"}),(0,x.jsx)("svg",{className:c.passwordToggleIcon,onClick:P(y),width:"20px",height:"20px",children:(0,x.jsx)("use",{xlinkHref:`${p.A}#${I?"icon-eye":"icon-eye-slash"}`})}),(0,x.jsx)(n.Kw,{name:"password",component:"p",className:c.errorMessage})]})]}),(0,x.jsxs)("div",{className:c.formGroupPassword,children:[(0,x.jsx)("label",{className:c.label,children:"Repeat new password:"}),(0,x.jsxs)("div",{className:c.inputWrapper,children:[(0,x.jsx)(n.D0,{type:b?"text":"password",name:"repeatPassword",className:`${c.input}`,placeholder:"Password"}),(0,x.jsx)("svg",{className:c.passwordToggleIcon,onClick:P(f),width:"20px",height:"20px",children:(0,x.jsx)("use",{xlinkHref:`${p.A}#${b?"icon-eye":"icon-eye-slash"}`})}),(0,x.jsx)(n.Kw,{name:"repeatPassword",component:"p",className:c.errorMessage})]})]})]})]}),(0,x.jsx)("div",{className:c.buttonWrapper,children:(0,x.jsx)("button",{type:"submit",className:`btn btn-blue ${c.button}`,disabled:r,children:"Save"})})]})}})}}}]);
//# sourceMappingURL=717.d44c7bc2.chunk.js.map