"use strict";(self.webpackChunkreact_homework_template=self.webpackChunkreact_homework_template||[]).push([[717],{8717:(e,s,r)=>{r.r(s),r.d(s,{default:()=>x});var a=r(5043),t=r(3003),n=r(3892),o=r(899);const l=o.Ik().shape({name:o.Yj().required("Please enter your name!").min(2,"Name must be at least 2 characters long.").max(20,"Name must be less than 20 characters long."),email:o.Yj().required("Please enter your email address.").matches(/^[^@]+@[^@]+\.[^@]+$/,"Please enter a valid email address.").email("Invalid email."),gender:o.Yj().oneOf(["woman","man",""],'Gender must be either "woman" or "man".'),password:o.Yj().min(4,"The passsword must contain at least 4 symbols!").max(8,"The password must contain no more than 8 characters!"),newPassword:o.Yj().min(4,"The passsword must contain at least 4 symbols!").max(8,"The password must contain no more than 8 characters!"),newPasswordRepeat:o.Yj().min(4,"The passsword must contain at least 4 symbols!").max(8,"The password must contain no more than 8 characters!")});var i=r(3768),m=r(3978);const p={passwordTitle:"UserSettingsForm_passwordTitle__dSurm",imageTitle:"UserSettingsForm_imageTitle__MD5jd",formWrapper:"UserSettingsForm_formWrapper__ujyOt",imageWrapper:"UserSettingsForm_imageWrapper__U8Q4Q",image:"UserSettingsForm_image__+uTGC",upload:"UserSettingsForm_upload__t9HPd",imageInput:"UserSettingsForm_imageInput__jEiRz",uploadIcon:"UserSettingsForm_uploadIcon__0dJZK",text:"UserSettingsForm_text__EFO7E",inputTitle:"UserSettingsForm_inputTitle__ESP2R",genderInputWrapper:"UserSettingsForm_genderInputWrapper__sP33D",genderButton:"UserSettingsForm_genderButton__Z0gIT",userInroWrapper:"UserSettingsForm_userInroWrapper__RJtcK",userInputWrap:"UserSettingsForm_userInputWrap__dhGBC",userInputTitle:"UserSettingsForm_userInputTitle__stZDh",userInput:"UserSettingsForm_userInput__0SRz+",error:"UserSettingsForm_error__1O6VL",accentText:"UserSettingsForm_accentText__7Kn5v",iconImportant:"UserSettingsForm_iconImportant__OOWTR",accentTextL:"UserSettingsForm_accentTextL__rS9Gm",header:"UserSettingsForm_header__nswTc",label:"UserSettingsForm_label__DuSbd",formGroupPassword:"UserSettingsForm_formGroupPassword__yDKPK",input:"UserSettingsForm_input__7fym4",errorMessage:"UserSettingsForm_errorMessage__NPkUw",inputWrapper:"UserSettingsForm_inputWrapper__mv+is",buttonWrapper:"UserSettingsForm_buttonWrapper__gGKFi",passwordToggleIcon:"UserSettingsForm_passwordToggleIcon__lk76R",btnWrapper:"UserSettingsForm_btnWrapper__eG2bt",placeholder:"UserSettingsForm_placeholder__qf4U-",flexWrap:"UserSettingsForm_flexWrap__RvIfu",settingsWrapper:"UserSettingsForm_settingsWrapper__cqFYn",userWrapper:"UserSettingsForm_userWrapper__Bkg+5",userSettings:"UserSettingsForm_userSettings__-yspq",formFlexWrapper:"UserSettingsForm_formFlexWrapper__xqYgJ",formFlexItem:"UserSettingsForm_formFlexItem__mnUxu",passwordWrapper:"UserSettingsForm_passwordWrapper__ltSFO",cancelButton:"UserSettingsForm_cancelButton__nvpjo"};var c=r(7920),d=r(8344),u=r(6213);(0,d.zD)("user/getUser",(async(e,s)=>{try{return(await u.A.get(`/user/${e}`)).data}catch(t){var r,a;return s.rejectWithValue((null===(r=t.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||t.message)}}));const g=(0,d.zD)("user/updateUser",(async(e,s)=>{let{userId:r,userData:a}=e;try{return(await u.A.put(`/user/${r}`,a)).data}catch(o){var t,n;return console.error("Update user error:",o),s.rejectWithValue((null===(t=o.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||o.message)}})),_=(0,d.zD)("user/updateAvatar",(async(e,s)=>{let{userId:r,avatarFile:a}=e;try{const e=new FormData;e.append("avatar",a);return(await u.A.patch(`/user/${r}`,e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(o){var t,n;return s.rejectWithValue((null===(t=o.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||o.message)}}));var h=r(579);const x=e=>{let{onClose:s}=e;const r=(0,t.wA)(),o=(0,t.d4)(m.mB)||{},{_id:d,name:u,email:x,gender:w,avatar:j}=o,v=(0,a.useRef)(null),[N,S]=(0,a.useState)(j||null),[F,U]=(0,a.useState)(!1),[W,I]=(0,a.useState)(!1),[b,f]=(0,a.useState)(!1);(0,a.useEffect)((()=>{S(j||null)}),[j]);const y=(0,a.useCallback)((async e=>{const s=e.target.files[0];if(s){const e=URL.createObjectURL(s);S(e);try{await r(_({userId:d,avatarFile:s})),i.oR.success("Avatar updated successfully!")}catch(a){i.oR.error("Error updating avatar. Please try again."),console.error(a)}}}),[r,d]),T=e=>()=>{e((e=>!e))},P=u?u.charAt(0).toUpperCase():"",$={name:u,email:x,gender:w||"woman",oldPassword:"",password:"",repeatPassword:""};return(0,h.jsx)(n.l1,{initialValues:$,validationSchema:l,onSubmit:async e=>{const s=Object.fromEntries(Object.entries(e).filter((e=>{let[s,r]=e;return""!==r&&"avatar"!==s})));console.log(s);try{await r(g({userId:d,userData:s})),i.oR.success("User updated successfully!")}catch(a){i.oR.error("Error updating user. Please try again."),console.error(a)}},children:e=>{let{setFieldValue:s,isSubmitting:r}=e;return(0,h.jsxs)(n.lV,{children:[(0,h.jsxs)("div",{className:p.settingsWrapper,children:[(0,h.jsxs)("div",{className:p.userWrapper,children:[(0,h.jsx)("p",{className:p.imageTitle,children:"Your Photo"}),(0,h.jsxs)("div",{className:p.imageWrapper,children:[(0,h.jsx)("div",{className:p.imageContainer,children:N?(0,h.jsx)("img",{className:p.image,src:N,alt:"User avatar",width:"75",height:"75"}):(0,h.jsx)("div",{className:p.placeholder,children:P})}),(0,h.jsxs)("label",{className:p.upload,children:[(0,h.jsx)("input",{className:p.imageInput,type:"file",accept:"image/*",onChange:e=>{y(e),s("avatar",e.currentTarget.files[0])},ref:v}),(0,h.jsx)("svg",{className:p.uploadIcon,width:"18",height:"18",children:(0,h.jsx)("use",{xlinkHref:`${c.A}#icon-upload`})}),(0,h.jsx)("p",{className:p.text,children:"Upload a photo"})]})]}),(0,h.jsxs)("div",{className:p.formWrapper,children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("h2",{className:p.inputTitle,children:"Your gender identity"}),(0,h.jsxs)("div",{className:p.genderInputWrapper,children:[(0,h.jsxs)("label",{className:`${p.genderButton} ${p.text}`,children:[(0,h.jsx)(n.D0,{type:"radio",name:"gender",value:"woman",className:p.genderInput}),"Woman"]}),(0,h.jsxs)("label",{className:`${p.genderButton} ${p.text}`,children:[(0,h.jsx)(n.D0,{type:"radio",name:"gender",value:"man",className:p.genderInput}),"Man"]})]}),(0,h.jsx)(n.Kw,{name:"gender",component:"p",className:p.error})]}),(0,h.jsx)("div",{className:p.formFlexWrapper,children:(0,h.jsx)("div",{className:p.formFlexItem,children:(0,h.jsxs)("div",{className:p.userInfoWrapper,children:[(0,h.jsxs)("div",{className:p.userInputWrap,children:[(0,h.jsx)("label",{className:p.userInputTitle,htmlFor:"name",children:"Your name"}),(0,h.jsx)(n.D0,{type:"text",name:"name",id:"name",className:`${p.userInput} ${p.userSettings} ${p.text}`}),(0,h.jsx)(n.Kw,{name:"name",component:"p",className:p.error})]}),(0,h.jsxs)("div",{className:p.userInputWrap,children:[(0,h.jsx)("label",{className:p.userInputTitle,htmlFor:"email",children:"Email"}),(0,h.jsx)(n.D0,{type:"text",name:"email",id:"email",className:`${p.userInput} ${p.userSettings} ${p.text}`}),(0,h.jsx)(n.Kw,{name:"email",component:"p",className:p.error})]})]})})})]})]}),(0,h.jsxs)("div",{className:p.passwordWrapper,children:[(0,h.jsx)("h2",{className:p.passwordTitle,children:"Password"}),(0,h.jsxs)("div",{className:p.formGroupPassword,children:[(0,h.jsx)("label",{className:p.label,children:"Outdated password:"}),(0,h.jsxs)("div",{className:p.inputWrapper,children:[(0,h.jsx)(n.D0,{type:F?"text":"password",name:"oldPassword",className:`${p.input}`,placeholder:"Password"}),(0,h.jsx)("svg",{className:p.passwordToggleIcon,onClick:T(U),width:"20px",height:"20px",children:(0,h.jsx)("use",{xlinkHref:`${c.A}#${F?"icon-eye":"icon-eye-slash"}`})}),(0,h.jsx)(n.Kw,{name:"oldPassword",component:"p",className:p.errorMessage})]})]}),(0,h.jsxs)("div",{className:p.formGroupPassword,children:[(0,h.jsx)("label",{className:p.label,children:"New Password:"}),(0,h.jsxs)("div",{className:p.inputWrapper,children:[(0,h.jsx)(n.D0,{type:W?"text":"password",name:"password",className:`${p.input}`,placeholder:"Password"}),(0,h.jsx)("svg",{className:p.passwordToggleIcon,onClick:T(I),width:"20px",height:"20px",children:(0,h.jsx)("use",{xlinkHref:`${c.A}#${W?"icon-eye":"icon-eye-slash"}`})}),(0,h.jsx)(n.Kw,{name:"password",component:"p",className:p.errorMessage})]})]}),(0,h.jsxs)("div",{className:p.formGroupPassword,children:[(0,h.jsx)("label",{className:p.label,children:"Repeat new password:"}),(0,h.jsxs)("div",{className:p.inputWrapper,children:[(0,h.jsx)(n.D0,{type:b?"text":"password",name:"repeatPassword",className:`${p.input}`,placeholder:"Password"}),(0,h.jsx)("svg",{className:p.passwordToggleIcon,onClick:T(f),width:"20px",height:"20px",children:(0,h.jsx)("use",{xlinkHref:`${c.A}#${b?"icon-eye":"icon-eye-slash"}`})}),(0,h.jsx)(n.Kw,{name:"repeatPassword",component:"p",className:p.errorMessage})]})]})]})]}),(0,h.jsx)("div",{className:p.buttonWrapper,children:(0,h.jsx)("button",{type:"submit",className:`btn btn-blue ${p.button}`,disabled:r,children:"Save"})})]})}})}}}]);
//# sourceMappingURL=717.3e3c6299.chunk.js.map